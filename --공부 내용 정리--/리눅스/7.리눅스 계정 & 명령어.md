# 리눅스 계정 & 명령어

## 계정 관리

### 인증과 권한 부여 (Authentication & Permission)

- **인증 (Authentication)**
    - **정의:** 시스템 내에서 등록된 사용자임을 확인.
    - **방법:**
        - ID/PW
        - 지문 인증
        - 홍채 인증 등
    - **과정:**
        - **식별:** ID를 확인
        - **인증:** PW의 일치 여부 확인
- **권한 부여 (Permission)**
    - **정의:** 소유권 및 허가권 부여
    - **역할:** 사용자가 시스템 내에서 어떤 자원에 접근할 수 있는지 결정
- **인가 (Authorization)**
    - **정의:** 인증 + 권한 부여
    - **예시:** ID/PW를 통한 인가 과정

---

## 리눅스 계정 관련 파일

> 참고: 시험에는 출제되지 않지만 정리해두면 유용함
> 

### 계정 생성 시 필요한 정보 저장 파일

- **/etc/login.defs** (또는 **/etc/default/useradd**)
    - **역할:**
        - 계정의 보안 관련 설정
            - 패스워드 관련 설정 다수 포함
        - 계정 경로 관련 설정
            - 계정 개별 Home 디렉토리 경로
            - 계정 Skel 경로 설정

### 계정 생성 요청 이후 해당 계정의 개별 정보

- **/etc/passwd**
    - **내용:**
        - 사용자 기본 정보
        - 계정명, UID, GID, 개별 Home 디렉토리 경로, 쉘 종류 등
- **/etc/shadow**
    - **내용:**
        - 암호화된 패스워드 저장
        - **접근 권한:** root 계정만 확인 가능
- **/etc/group**
    - **내용:**
        - 그룹 계정 정보 저장
- **/home/개별홈디렉토리**
    - **역할:**
        - 개별 계정마다 부여되는 작업 공간
- **/var/spool/mail/개별메일파일**
    - **역할:**
        - 개별 임시 메일함

---

## 무결성 알고리즘

- **특징:**
    - **단방향성 (One-way)**
        - 복호화 불가능
    - **의미:** 데이터의 무결성을 보장하기 위해 사용되며, 원본 데이터를 복원할 수 없음

---

### 요약

- *인증(Authentication)**은 사용자의 신원을 확인하는 과정이며, **권한 부여(Permission)**는 사용자가 시스템 내에서 수행할 수 있는 작업을 결정합니다. 이 두 과정을 합친 것이 **인가(Authorization)** 입니다.
- 리눅스 시스템에서는 다양한 파일을 통해 사용자 계정과 관련된 정보를 관리합니다. 주요 파일로는 `/etc/passwd`, `/etc/shadow`, `/etc/group` 등이 있으며, 각 사용자에게는 별도의 홈 디렉토리와 메일 파일이 제공됩니다.
- 무결성 알고리즘은 단방향성을 가지며, 데이터를 복호화할 수 없도록 설계되어 데이터의 안전성을 유지합니다.

# `useradd` : 사용자 계정 생성 명령어

---

## 옵션

- **u** : UID 지정
- **g** : 주 그룹 지정
- **G** : 보조 그룹 지정
- **c** : 주석, 설명
- **d** : 홈 디렉토리 경로 지정
- **m** : 홈 디렉토리 생성 (메뉴얼 참조: `man useradd`)
- **k** : 스켈디렉토리 경로 지정
- **s** : 쉘 지정

---

## 실습 - 옵션 적용

### 유저 생성1

```bash
useradd test1
useradd -u 510 test2
```

### 유저 생성2 (그룹 지정)

```bash
useradd -g test1 test3
# 참고: 그룹을 지정하지 않으면 UID와 동일한 GID의 그룹이 생성됩니다.
useradd -G heath test4
```

### 유저 생성3 (주석, 설명)

```bash
useradd -c "korea" test5
```

### 유저 생성4 (홈 디렉토리 경로 지정)

```bash
useradd -d /export/home/test6 test6
useradd -d /export/home test8
useradd -d /export/home/heath test9
```

**주의사항:**

1. 홈 디렉토리 경로를 변경할 경우, 해당 홈 디렉토리를 먼저 생성해야 합니다.
2. 홈 디렉토리 경로를 지정할 때는 경로 끝에 계정명과 동일한 홈 디렉토리명을 포함해야 합니다.

### 유저 생성5 (스켈 디렉토리 경로 지정)

```bash
useradd -m -k /skeltest test7
```

**참고:** `skel` 디렉토리는 홈 디렉토리를 구성하는 기본 파일들을 포함하며, 계정 생성 시 한 번만 복사됩니다.

### 유저 생성6 (쉘 지정)

```bash
useradd -s /bin/ksh test10
```

## 미니 문제

다음 요구사항에 맞게 사용자 계정을 생성하세요.

### 문제 및 해결

1. **test10 계정 생성 시 UID 값 1800으로 지정**
    
    ```bash
    useradd -u 1800 test10
    ```
    
2. **test20 계정 생성 시 주 그룹을 test10으로 지정**
    
    ```bash
    useradd -g test10 test20
    ```
    
3. **test30 계정 생성 시 보조 그룹 test10 추가**
    
    ```bash
    useradd -G test10 test30
    ```
    
4. **test40 계정 생성 시 홈 디렉토리 경로를 /export/test40으로 지정**
    
    ```bash
    # /export 디렉토리가 존재하지 않을 경우 생성
    mkdir -p /export
    
    # 홈 디렉토리 경로를 /export/test40으로 지정하여 test40 계정 생성
    useradd -d /export/test40 test40
    ```
    
5. **test50 계정 생성 시 스켈 경로를 /skel2로 하고 test50 홈디렉토리에 test50 파일이 생성되도록 설정**
    
    ```bash
    # 기존 /etc/skel을 /skel2로 복사
    cp -r /etc/skel /skel2
    
    # 스켈 디렉토리에 test50 파일 생성
    touch /skel2/test50
    
    //skel2에 test50파일을 만들고 나서 새로운 계정의 스켈 디렉토리를 skel2로 설정을 하고 계정을 생성하면 새로운 계정의 home 디렉토리에 skel2 내용이 복사된다.
    
    # 스켈 디렉토리를 /skel2로 지정하여 test50 계정 생성 및 홈 디렉토리 생성
    useradd -m -k /skel2 test50
    
    # 추가로 test50 홈 디렉토리에 test50 파일이 존재하는지 확인
    ls /export/home/test50/test50
    ```
    
    **설명:**
    
    - `m` 옵션으로 홈 디렉토리를 생성합니다.
    - `k /skel2` 옵션으로 스켈 디렉토리를 `/skel2`로 지정합니다.
    - `touch /skel2/test50` 명령어로 `test50` 홈 디렉토리에 `test50` 파일이 생성되도록 스켈 디렉토리에 미리 파일을 추가합니다.

<aside>
💡

### **스켈레톤 디렉토리의 작동 방식**

1. **스켈레톤 디렉토리 설정** : 스켈레톤 디렉토리에 포함된 파일과 디렉토리는 사용자가 생성될 때 해당 사용자의 홈 디렉토리로 복사됩니다.
2. **사용자 생성 시 복사** : `useradd` 명령어를 사용하여 사용자를 생성할 때, 지정된 스켈레톤 디렉토리의 내용이 홈 디렉토리에 복사됩니다.
3. 만약 사용자가 이미 생성된 후에 스켈레톤 디렉토리에 파일을 추가하거나 변경한다면, 해당 변경 사항은 이미 생성된 사용자의 홈 디렉토리에 영향을 미치지 않습니다.

즉 skel을 skel2로 복사하고 skel2에 test50 파일을 만들고 마지막으로 계정을 만들어야 한다.

</aside>

1. **test60 계정 생성 시 쉘을 /bin/ksh로 설정**
    
    ```bash
    useradd -s /bin/ksh test60
    
    ```
